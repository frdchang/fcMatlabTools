function cameraNoiseVar = genSCMOSNoiseVar(sizes,varargin)
%GENLOGNORMALNOISEVAR will generate scmos noise from an empiricle
% distribution measured from our camera ID001486 - Cooler Air.
% calibration file is from 20160625 of the center 1024x1024 ROI
% calibration was done for fast scan and slow scan
% gain of this camera is = 0.49 electrons/count

% dead pixel percentile calculated by doing a mean variance curve, fitting
% a line, then plotting the histogram of the mean sq error and measuring
% the area at the tail.

%--constants---------------------------------------------------------------
percentDeadPixels = 0.0093;
gainElectonsPerCount = 0.49;
%--parameters--------------------------------------------------------------
params.extrudeInZ     = true;
params.scanType       = 'fast';         % {'slow','fast'}
params.units          = 'electrons';    % {'electrons','ADUs'};
%--------------------------------------------------------------------------
params = updateParams(params,varargin);

% in units of electrons
slowScanEdges =[0.54 0.57 0.6 0.63 0.66 0.69 0.72 0.75 0.78 0.81 0.84 0.87 0.9 0.93 0.96 0.99 1.02 1.05 1.08 1.11 1.14 1.17 1.2 1.23 1.26 1.29 1.32 1.35 1.38 1.41 1.44 1.47 1.5 1.53 1.56 1.59 1.62 1.65 1.68 1.71 1.74 1.77 1.8 1.83 1.86 1.89 1.92 1.95 1.98 2.01 2.04 2.07 2.1 2.13 2.16 2.19 2.22 2.25 2.28 2.31 2.34 2.37 2.4 2.43 2.46 2.49 2.52 2.55 2.58 2.61 2.64 2.67 2.7 2.73 2.76 2.79 2.82 2.85 2.88 2.91 2.94 2.97 3 3.03 3.06 3.09 3.12 3.15 3.18 3.21 3.24 3.27 3.3 3.33 3.36 3.39 3.42 3.45 3.48 3.51 3.54 3.57 3.6 3.63 3.66 3.69 3.72 3.75 3.78 3.81 3.84 3.87 3.9 3.93 3.96 3.99 4.02 4.05 4.08 4.11 4.14 4.17 4.2 4.23 4.26 4.29 4.32 4.35 4.38 4.41 4.44 4.47 4.5 4.53 4.56 4.59 4.62 4.65 4.68 4.71 4.74 4.77 4.8 4.83 4.86 4.89 4.92 4.95 4.98 5.01 5.04 5.07 5.1 5.13 5.16 5.19 5.22 5.25 5.28 5.31 5.34 5.37 5.4 5.43 5.46 5.49 5.52 5.55 5.58 5.61 5.64 5.67 5.7 5.73 5.76 5.79 5.82 5.85 5.88 5.91 5.94 5.97 6 6.03 6.06 6.09 6.12 6.15 6.18 6.21 6.24 6.27 6.3 6.33 6.36 6.39 6.42 6.45 6.48 6.51 6.54 6.57 6.6 6.63 6.66 6.69 6.72 6.75 6.78 6.81 6.84 6.87 6.9 6.93 6.96 6.99 7.02 7.05 7.08 7.11 7.14 7.17 7.2 7.23 7.26 7.29 7.32 7.35 7.38 7.41 7.44 7.47 7.5 7.53 7.56 7.59 7.62 7.65 7.68 7.71 7.74 7.77 7.8 7.83 7.86 7.89 7.92 7.95 7.98 8.01 8.04 8.07 8.1 8.13 8.16 8.19 8.22 8.25 8.28 8.31 8.34 8.37 8.4 8.43 8.46 8.49 8.52 8.55 8.58 8.61 8.64 8.67 8.7 8.73 8.76 8.79 8.82 8.85 8.88 8.91 8.94 8.97 9 9.03 9.06 9.09 9.12 9.15 9.18 9.21 9.24 9.27 9.3 9.33 9.36 9.39 9.42 9.45 9.48 9.51 9.54 9.57 9.6 9.63 9.66 9.69 9.72 9.75 9.78 9.81 9.84 9.87 9.9 9.93 9.96 9.99 10.02 10.05 10.08 10.11 10.14 10.17 10.2 10.23 10.26 10.29 10.32 10.35 10.38 10.41 10.44 10.47 10.5 10.53 10.56 10.59 10.62 10.65 10.68 10.71 10.74 10.77 10.8 10.83 10.86 10.89 10.92 10.95 10.98 11.01 11.04 11.07 11.1 11.13 11.16 11.19 11.22 11.25 11.28 11.31 11.34 11.37 11.4 11.43 11.46 11.49 11.52 11.55 11.58 11.61 11.64 11.67 11.7 11.73 11.76 11.79 11.82 11.85 11.88 11.91 11.94 11.97 12 12.03 12.06 12.09 12.12 12.15 12.18 12.21 12.24 12.27 12.3 12.33 12.36 12.39 12.42 12.45 12.48 12.51 12.54 12.57 12.6 12.63 12.66 12.69 12.72 12.75 12.78 12.81 12.84 12.87 12.9 12.93 12.96 12.99 13.02 13.05 13.08 13.11 13.14 13.17 13.2 13.23 13.26 13.29 13.32 13.35 13.38 13.41 13.44 13.47 13.5 13.53 13.56 13.59 13.62 13.65 13.68 13.71 13.74 13.77 13.8 13.83 13.86 13.89 13.92 13.95 13.98 14.01 14.04 14.07 14.1 14.13 14.16 14.19 14.22 14.25 14.28 14.31 14.34 14.37 14.4 14.43 14.46 14.49 14.52 14.55 14.58 14.61 14.64 14.67 14.7 14.73 14.76 14.79 14.82 14.85 14.88 14.91 14.94 14.97 15 15.03 15.06 15.09 15.12 15.15 15.18 15.21 15.24 15.27 15.3 15.33 15.36 15.39 15.42 15.45 15.48 15.51 15.54 15.57 15.6 15.63 15.66 15.69 15.72 15.75 15.78 15.81 15.84 15.87 15.9 15.93 15.96 15.99 16.02 16.05 16.08 16.11 16.14 16.17 16.2 16.23 16.26 16.29 16.32 16.35 16.38 16.41 16.44 16.47 16.5 16.53 16.56 16.59 16.62 16.65 16.68 16.71 16.74 16.77 16.8 16.83 16.86 16.89 16.92 16.95 16.98 17.01 17.04 17.07 17.1 17.13 17.16 17.19 17.22 17.25 17.28 17.31 17.34 17.37 17.4 17.43 17.46 17.49 17.52 17.55 17.58 17.61 17.64 17.67 17.7 17.73 17.76 17.79 17.82 17.85 17.88 17.91 17.94 17.97 18 18.03 18.06 18.09 18.12 18.15 18.18 18.21 18.24 18.27 18.3 18.33 18.36 18.39 18.42 18.45 18.48 18.51 18.54 18.57 18.6 18.63 18.66 18.69 18.72 18.75 18.78 18.81 18.84 18.87 18.9 18.93 18.96 18.99 19.02 19.05 19.08 19.11 19.14 19.17 19.2 19.23 19.26 19.29 19.32 19.35 19.38 19.41 19.44 19.47 19.5 19.53 19.56 19.59 19.62 19.65 19.68 19.71 19.74 19.77 19.8 19.83 19.86 19.89 19.92 19.95 19.98 20.01 20.04 20.07 20.1 20.13 20.16 20.19 20.22 20.25 20.28 20.31 20.34 20.37 20.4 20.43 20.46 20.49 20.52 20.55 20.58 20.61 20.64 20.67 20.7 20.73 20.76 20.79 20.82 20.85 20.88 20.91 20.94 20.97 21];
slowScanVals =[0.000127156575520833 0.00565846761067708 0.120894114176433 0.626722971598307 1.2427012125651 1.98974609375001 3.05636723836263 3.61483891805013 3.23162078857422 2.52660115559896 2.07773844401042 1.71957015991211 1.37691497802734 1.09939575195313 0.862439473470051 0.719070434570312 0.605996449788411 0.519212086995442 0.454711914062503 0.406106313069658 0.365320841471357 0.336106618245442 0.310325622558593 0.279076894124349 0.251197814941406 0.234317779541015 0.205930074055989 0.18752415974935 0.17722447713216 0.162410736083985 0.146897633870443 0.136057535807292 0.131575266520182 0.119495391845703 0.116062164306641 0.108464558919271 0.103473663330079 0.0955899556477864 0.0924110412597655 0.0887870788574218 0.0831286112467447 0.0801086425781249 0.0801722208658854 0.0775655110677088 0.0738779703776041 0.0694910685221354 0.0686963399251301 0.0643412272135416 0.0609397888183598 0.0613530476888016 0.0594139099121089 0.0555674235026045 0.0554084777832035 0.0525474548339839 0.0508944193522139 0.0514984130859378 0.0494321187337236 0.0494639078776038 0.046189626057943 0.0435829162597659 0.0448226928710934 0.0436464945475263 0.0421206156412763 0.0422159830729163 0.0405629475911455 0.0389099121093753 0.0375111897786461 0.0367800394694007 0.0358581542968752 0.0335057576497393 0.0341733296712242 0.0344276428222653 0.0337282816569013 0.0323295593261721 0.0325838724772133 0.0291506449381512 0.0306447347005206 0.0315348307291669 0.0303586324055987 0.0281651814778648 0.0269889831542971 0.0259081522623696 0.0275611877441408 0.0282287597656248 0.0246047973632814 0.0252723693847654 0.0238418579101564 0.0227292378743491 0.0229517618815102 0.0228563944498699 0.0231742858886717 0.0232696533203127 0.0217437744140623 0.0205993652343751 0.0193913777669269 0.0207901000976564 0.0188509623209637 0.0192324320475259 0.0182151794433595 0.0177701314290363 0.0184059143066407 0.0171661376953124 0.017070770263672 0.0176111857096353 0.0156084696451824 0.0157992045084636 0.0169754028320311 0.0157992045084636 0.0152905782063801 0.0161806742350261 0.0163396199544269 0.0145912170410157 0.0153859456380209 0.0146547953287759 0.0150680541992188 0.0145276387532553 0.0124295552571614 0.0132560729980468 0.0134150187174482 0.0120162963867187 0.0137011210123697 0.0105857849121096 0.0136375427246089 0.0111897786458336 0.0122070312499999 0.0112533569335937 0.0115394592285159 0.0116030375162759 0.0114123026529947 0.0106811523437502 0.0109672546386718 0.0102678934733072 0.0100771586100263 0.00934600830078117 0.0102043151855468 0.00861485799153639 0.0095367431640627 0.00858306884765618 0.00918706258138013 0.00921885172526034 0.00855127970377622 0.0094413757324218 0.00915527343749992 0.00785191853841139 0.00839233398437518 0.00715255737304682 0.00864664713541659 0.00759760538736995 0.00743865966796869 0.00718434651692702 0.00686645507812494 0.00769297281901058 0.00794728597005202 0.00734329223632806 0.00613530476888034 0.0067075093587239 0.00578562418619787 0.00635782877604161 0.00689824422200536 0.00594456990559891 0.00588099161783849 0.00616709391276055 0.00540415445963537 0.00667572021484369 0.00578562418619787 0.00549952189127616 0.00537236531575516 0.00588099161783849 0.00546773274739595 0.00584920247395828 0.00572204589843745 0.00575383504231766 0.00480016072591156 0.005499521891276 0.00451405843098955 0.00483194986979177 0.00454584757486975 0.0055313110351562 0.00400543212890622 0.00445048014322926 0.0039418538411458 0.00457763671874996 0.00403722127278643 0.00416437784830738 0.00381469726562497 0.00381469726562497 0.0035285949707032 0.00349680582682289 0.00336964925130206 0.0035285949707031 0.00486373901367198 0.00336964925130206 0.0031471252441406 0.00330607096354174 0.00324249267578122 0.00362396240234372 0.00336964925130206 0.00311533610026048 0.00254313151041665 0.0027656555175781 0.00324249267578132 0.00311533610026039 0.00267028808593748 0.0027656555175781 0.00273386637369798 0.00305175781249997 0.00254313151041665 0.00270207722981769 0.00219345092773442 0.00216166178385415 0.00212987263997394 0.00257492065429693 0.00244776407877602 0.00267028808593748 0.00209808349609373 0.00187555948893233 0.00219345092773436 0.00241597493489581 0.00267028808593756 0.00219345092773436 0.00219345092773436 0.00165303548177082 0.002129872639974 0.00209808349609373 0.00203450520833332 0.00184377034505212 0.00187555948893228 0.00184377034505207 0.00152587890624999 0.00155766805013024 0.00241597493489581 0.00130335489908853 0.00133514404296878 0.00152587890624999 0.00187555948893228 0.00219345092773436 0.00123977661132815 0.0015576680501302 0.00178019205729165 0.0013987223307292 0.00178019205729165 0.00171661376953124 0.00187555948893228 0.00152587890625003 0.00146230061848957 0.00130335489908853 0.00127156575520832 0.00120798746744794 0.00178019205729165 0.00114440917968752 0.00120798746744787 0.000985463460286479 0.00117619832356773 0.00117619832356766 0.00146230061848961 0.00123977661132815 0.000985463460286421 0.00136693318684899 0.00120798746744794 0.00108083089192704 0.00139872233072911 0.000953674316406327 0.00104904174804684 0.000794728597005178 0.00111262003580738 0.000858306884765592 0.0008900960286458 0.00130335489908865 0.000858306884765592 0.00101725260416663 0.00069936116536464 0.000540415445963521 0.000826517740885385 0.000762939453125061 0.0008900960286458 0.000921885172526007 0.000731150309244764 0.000890096028645905 0.000635782877604143 0.000762939453124971 0.000858306884765694 0.000540415445963521 0.000826517740885385 0.000921885172526116 0.0004450480143229 0.000953674316406214 0.000858306884765694 0.000317891438802071 0.000476837158203107 0.000890096028645905 0.00066757202148435 0.000476837158203107 0.000476837158203163 0.000603993733723935 0.000572204589843728 0.000540415445963585 0.000635782877604143 0.000476837158203107 0.000794728597005272 0.000603993733723935 0.000508626302083314 0.000476837158203107 0.00034968058268232 0.000699361165364557 0.000699361165364557 0.000381469726562531 0.000317891438802071 0.000381469726562486 0.000667572021484429 0.000349680582682278 0.000508626302083314 0.000413258870442742 0.000349680582682278 0.000572204589843728 0.000413258870442742 0.000349680582682278 0.000413258870442693 0.000413258870442742 0.000349680582682278 0.000381469726562486 0.000445048014322953 0.000286102294921864 0.000286102294921864 0.000540415445963585 0.000127156575520829 0.000476837158203107 0.00022252400716145 0.000286102294921898 0.000349680582682278 0.000254313151041657 0.000254313151041687 0.000190734863281243 0.000190734863281243 0.000381469726562531 0.000317891438802071 0.000317891438802071 0.000222524007161476 0.000413258870442693 0.000349680582682278 0.000286102294921898 0.000127156575520829 0.000190734863281243 0.000317891438802109 0.000158945719401036 0.00022252400716145 0.000413258870442742 0.000254313151041657 0.000190734863281243 0.000286102294921898 0.000381469726562486 0.000190734863281243 0.000127156575520844 0.000317891438802071 0.000127156575520829 0.00022252400716145 0.000413258870442742 0.000127156575520829 0.000286102294921864 9.53674316406327e-05 0.000317891438802071 0.000254313151041657 0.000286102294921898 0.000190734863281243 0.000254313151041657 0.000222524007161476 0.000190734863281243 0.000254313151041657 0.000190734863281265 0.000286102294921864 0.000286102294921864 0.000158945719401054 0.000190734863281243 0.000190734863281243 0.000158945719401054 0.000190734863281243 3.17891438802071e-05 0.000158945719401054 9.53674316406214e-05 0.000317891438802071 6.35782877604143e-05 0.000254313151041687 0.00022252400716145 0.000127156575520829 0.000381469726562531 0.000158945719401036 0.000254313151041657 0.000190734863281265 0.000127156575520829 9.53674316406214e-05 3.17891438802109e-05 0.00022252400716145 9.53674316406214e-05 9.53674316406327e-05 0.000158945719401036 9.53674316406214e-05 6.35782877604218e-05 9.53674316406214e-05 0.000127156575520829 0.000127156575520844 0.000158945719401036 0.000127156575520829 0.000254313151041687 0.000127156575520829 9.53674316406214e-05 6.35782877604143e-05 0.000190734863281265 9.53674316406214e-05 0.000190734863281243 9.53674316406327e-05 3.17891438802071e-05 6.35782877604143e-05 0.000127156575520844 0.000190734863281243 6.35782877604143e-05 9.53674316406327e-05 3.17891438802071e-05 0.000127156575520829 6.35782877604218e-05 3.17891438802071e-05 3.17891438802071e-05 3.17891438802109e-05 0 3.17891438802071e-05 0.000190734863281265 9.53674316406214e-05 9.53674316406214e-05 3.17891438802109e-05 0 9.53674316406214e-05 3.17891438802071e-05 6.35782877604218e-05 9.53674316406214e-05 0 6.35782877604218e-05 0 6.35782877604143e-05 6.35782877604218e-05 3.17891438802071e-05 0.000190734863281243 6.35782877604218e-05 3.17891438802071e-05 9.53674316406214e-05 0 0 9.53674316406214e-05 6.35782877604218e-05 6.35782877604143e-05 0 0 3.17891438802071e-05 6.35782877604143e-05 6.35782877604218e-05 3.17891438802071e-05 3.17891438802071e-05 0 3.17891438802109e-05 3.17891438802071e-05 6.35782877604143e-05 3.17891438802109e-05 6.35782877604143e-05 6.35782877604143e-05 9.53674316406327e-05 9.53674316406214e-05 6.35782877604143e-05 9.53674316406327e-05 3.17891438802071e-05 0 3.17891438802109e-05 3.17891438802071e-05 3.17891438802071e-05 6.35782877604218e-05 3.17891438802071e-05 3.17891438802071e-05 3.17891438802109e-05 3.17891438802071e-05 0 9.53674316406327e-05 0 0 3.17891438802109e-05 3.17891438802071e-05 3.17891438802071e-05 3.17891438802071e-05 3.17891438802109e-05 9.53674316406214e-05 9.53674316406214e-05 0 3.17891438802071e-05 3.17891438802071e-05 0 0 3.17891438802071e-05 6.35782877604218e-05 6.35782877604143e-05 0 0 0 3.17891438802071e-05 6.35782877604218e-05 6.35782877604143e-05 3.17891438802071e-05 3.17891438802109e-05 3.17891438802071e-05 3.17891438802071e-05 0 3.17891438802071e-05 0 6.35782877604143e-05 6.35782877604218e-05 3.17891438802071e-05 0 6.35782877604218e-05 0 0 6.35782877604218e-05 3.17891438802071e-05 0 0 3.17891438802071e-05 3.17891438802071e-05 0 0 0 0 0 0 6.35782877604218e-05 3.17891438802071e-05 0 9.53674316406327e-05 0 0 6.35782877604143e-05 0 0 0 3.17891438802071e-05 0 0 0 0 6.35782877604218e-05 0 0 0 0 0 3.17891438802109e-05 3.17891438802071e-05 3.17891438802071e-05 0 0 3.17891438802071e-05 0 0 3.17891438802071e-05 6.35782877604143e-05 3.17891438802109e-05 0 3.17891438802071e-05 0 6.35782877604143e-05 3.17891438802071e-05 0 3.17891438802071e-05 0 0 0 3.17891438802071e-05 0 0 0 3.17891438802109e-05 0 0 3.17891438802071e-05 0 0 0 0 0 0 3.17891438802109e-05 0 0 3.17891438802109e-05 3.17891438802071e-05 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3.17891438802071e-05 6.35782877604218e-05 0 0 0 0 0 0 0 3.17891438802071e-05 0 0 0 3.17891438802109e-05 0 3.17891438802071e-05 0 0 0 3.17891438802109e-05 0 0 0 0 0 0 0 0 3.17891438802071e-05 0 0 0 0 0 0 0 0 0 0 0 0 3.17891438802109e-05 0 0 0 3.17891438802071e-05 0 0 0 0 0 0 0 0 3.17891438802109e-05 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3.17891438802071e-05];

fastScanEdges = [0.9 0.93 0.96 0.99 1.02 1.05 1.08 1.11 1.14 1.17 1.2 1.23 1.26 1.29 1.32 1.35 1.38 1.41 1.44 1.47 1.5 1.53 1.56 1.59 1.62 1.65 1.68 1.71 1.74 1.77 1.8 1.83 1.86 1.89 1.92 1.95 1.98 2.01 2.04 2.07 2.1 2.13 2.16 2.19 2.22 2.25 2.28 2.31 2.34 2.37 2.4 2.43 2.46 2.49 2.52 2.55 2.58 2.61 2.64 2.67 2.7 2.73 2.76 2.79 2.82 2.85 2.88 2.91 2.94 2.97 3 3.03 3.06 3.09 3.12 3.15 3.18 3.21 3.24 3.27 3.3 3.33 3.36 3.39 3.42 3.45 3.48 3.51 3.54 3.57 3.6 3.63 3.66 3.69 3.72 3.75 3.78 3.81 3.84 3.87 3.9 3.93 3.96 3.99 4.02 4.05 4.08 4.11 4.14 4.17 4.2 4.23 4.26 4.29 4.32 4.35 4.38 4.41 4.44 4.47 4.5 4.53 4.56 4.59 4.62 4.65 4.68 4.71 4.74 4.77 4.8 4.83 4.86 4.89 4.92 4.95 4.98 5.01 5.04 5.07 5.1 5.13 5.16 5.19 5.22 5.25 5.28 5.31 5.34 5.37 5.4 5.43 5.46 5.49 5.52 5.55 5.58 5.61 5.64 5.67 5.7 5.73 5.76 5.79 5.82 5.85 5.88 5.91 5.94 5.97 6 6.03 6.06 6.09 6.12 6.15 6.18 6.21 6.24 6.27 6.3 6.33 6.36 6.39 6.42 6.45 6.48 6.51 6.54 6.57 6.6 6.63 6.66 6.69 6.72 6.75 6.78 6.81 6.84 6.87 6.9 6.93 6.96 6.99 7.02 7.05 7.08 7.11 7.14 7.17 7.2 7.23 7.26 7.29 7.32 7.35 7.38 7.41 7.44 7.47 7.5 7.53 7.56 7.59 7.62 7.65 7.68 7.71 7.74 7.77 7.8 7.83 7.86 7.89 7.92 7.95 7.98 8.01 8.04 8.07 8.1 8.13 8.16 8.19 8.22 8.25 8.28 8.31 8.34 8.37 8.4 8.43 8.46 8.49 8.52 8.55 8.58 8.61 8.64 8.67 8.7 8.73 8.76 8.79 8.82 8.85 8.88 8.91 8.94 8.97 9 9.03 9.06 9.09 9.12 9.15 9.18 9.21 9.24 9.27 9.3 9.33 9.36 9.39 9.42 9.45 9.48 9.51 9.54 9.57 9.6 9.63 9.66 9.69 9.72 9.75 9.78 9.81 9.84 9.87 9.9 9.93 9.96 9.99 10.02 10.05 10.08 10.11 10.14 10.17 10.2 10.23 10.26 10.29 10.32 10.35 10.38 10.41 10.44 10.47 10.5 10.53 10.56 10.59 10.62 10.65 10.68 10.71 10.74 10.77 10.8 10.83 10.86 10.89 10.92 10.95 10.98 11.01 11.04 11.07 11.1 11.13 11.16 11.19 11.22 11.25 11.28 11.31 11.34 11.37 11.4 11.43 11.46 11.49 11.52 11.55 11.58 11.61 11.64 11.67 11.7 11.73 11.76 11.79 11.82 11.85 11.88 11.91 11.94 11.97 12 12.03 12.06 12.09 12.12 12.15 12.18 12.21 12.24 12.27 12.3 12.33 12.36 12.39 12.42 12.45 12.48 12.51 12.54 12.57 12.6 12.63 12.66 12.69 12.72 12.75 12.78 12.81 12.84 12.87 12.9 12.93 12.96 12.99 13.02 13.05 13.08 13.11 13.14 13.17 13.2 13.23 13.26 13.29 13.32 13.35 13.38 13.41 13.44 13.47 13.5 13.53 13.56 13.59 13.62 13.65 13.68 13.71 13.74 13.77 13.8 13.83 13.86 13.89 13.92 13.95 13.98 14.01 14.04 14.07 14.1 14.13 14.16 14.19 14.22 14.25 14.28 14.31 14.34 14.37 14.4 14.43 14.46 14.49 14.52 14.55 14.58 14.61 14.64 14.67 14.7 14.73 14.76 14.79 14.82 14.85 14.88 14.91 14.94 14.97 15 15.03 15.06 15.09 15.12 15.15 15.18 15.21 15.24 15.27 15.3 15.33 15.36 15.39 15.42 15.45 15.48 15.51 15.54 15.57 15.6 15.63 15.66 15.69 15.72 15.75 15.78 15.81 15.84 15.87 15.9 15.93 15.96 15.99 16.02 16.05 16.08 16.11 16.14 16.17 16.2 16.23 16.26 16.29 16.32 16.35 16.38 16.41 16.44 16.47 16.5 16.53 16.56 16.59 16.62 16.65 16.68 16.71 16.74 16.77 16.8 16.83 16.86 16.89 16.92 16.95 16.98 17.01 17.04 17.07 17.1 17.13 17.16 17.19 17.22 17.25 17.28 17.31 17.34 17.37 17.4 17.43 17.46 17.49 17.52 17.55 17.58 17.61 17.64 17.67 17.7 17.73 17.76 17.79 17.82 17.85 17.88 17.91 17.94 17.97 18 18.03 18.06 18.09 18.12 18.15 18.18 18.21 18.24 18.27 18.3 18.33 18.36 18.39 18.42 18.45 18.48 18.51 18.54 18.57 18.6 18.63 18.66 18.69 18.72 18.75 18.78 18.81 18.84 18.87 18.9 18.93 18.96 18.99 19.02 19.05 19.08 19.11 19.14 19.17 19.2 19.23 19.26 19.29 19.32 19.35 19.38 19.41 19.44 19.47 19.5 19.53 19.56 19.59 19.62 19.65 19.68 19.71 19.74 19.77 19.8 19.83 19.86 19.89 19.92 19.95 19.98 20.01 20.04 20.07 20.1 20.13 20.16 20.19 20.22 20.25 20.28 20.31 20.34 20.37 20.4 20.43 20.46 20.49 20.52 20.55 20.58 20.61 20.64 20.67 20.7 20.73 20.76 20.79 20.82 20.85 20.88 20.91 20.94 20.97 21 21.03 21.06 21.09 21.12 21.15 21.18 21.21 21.24 21.27 21.3 21.33 21.36 21.39 21.42 21.45 21.48 21.51 21.54 21.57 21.6 21.63 21.66 21.69 21.72 21.75 21.78 21.81 21.84 21.87 21.9 21.93 21.96 21.99 22.02 22.05 22.08 22.11 22.14 22.17 22.2 22.23 22.26 22.29 22.32 22.35 22.38 22.41 22.44 22.47 22.5 22.53 22.56 22.59 22.62 22.65 22.68 22.71 22.74 22.77 22.8 22.83 22.86 22.89 22.92 22.95 22.98 23.01 23.04 23.07 23.1 23.13 23.16 23.19 23.22 23.25 23.28 23.31 23.34 23.37 23.4 23.43 23.46 23.49 23.52 23.55 23.58 23.61 23.64 23.67 23.7 23.73 23.76 23.79 23.82 23.85 23.88 23.91 23.94 23.97 24 24.03 24.06 24.09 24.12 24.15 24.18 24.21 24.24 24.27 24.3 24.33 24.36 24.39 24.42 24.45 24.48 24.51 24.54 24.57 24.6 24.63 24.66 24.69 24.72 24.75 24.78 24.81 24.84 24.87 24.9 24.93 24.96 24.99 25.02 25.05 25.08 25.11 25.14 25.17 25.2 25.23 25.26 25.29 25.32 25.35 25.38 25.41 25.44 25.47 25.5 25.53 25.56 25.59 25.62 25.65 25.68 25.71 25.74 25.77 25.8 25.83 25.86 25.89 25.92 25.95 25.98 26.01 26.04 26.07 26.1 26.13 26.16 26.19 26.22 26.25 26.28 26.31 26.34 26.37 26.4 26.43];
fastScanVals = [3.17891438802083e-05 0.00441869099934895 0.102710723876953 0.895977020263668 2.62263615926108 3.84143193562825 3.83294423421224 3.19665273030599 2.58003870646159 2.04458236694336 1.58809026082357 1.22718811035157 0.970776875813794 0.790500640869146 0.660260518391926 0.575510660807291 0.50516128540039 0.450611114501953 0.404294331868492 0.354321797688799 0.314966837565106 0.271129608154297 0.250244140625 0.220521291097005 0.202433268229166 0.183709462483724 0.17248789469401 0.157356262207032 0.145022074381509 0.139141082763673 0.127410888671875 0.124454498291016 0.117015838623047 0.111802419026693 0.101693471272786 0.0996907552083332 0.0953992207845058 0.092124938964843 0.0882148742675787 0.0825564066569016 0.0787734985351556 0.0771840413411452 0.0740051269531255 0.0685691833496098 0.0673611958821609 0.0668525695800786 0.0654538472493494 0.0632921854654943 0.0595410664876297 0.0594774881998702 0.0576972961425785 0.0564575195312495 0.054264068603516 0.0521977742513024 0.0505447387695308 0.0484148661295569 0.0462532043457034 0.0485420227050784 0.0470479329427079 0.0463803609212243 0.0438690185546878 0.0417391459147132 0.0403086344401038 0.0394503275553388 0.0383059183756513 0.0382741292317705 0.0379880269368492 0.0369071960449216 0.0354131062825523 0.0348726908365883 0.0354131062825523 0.0343958536783851 0.0347455342610679 0.0330924987792971 0.0329335530598956 0.0298182169596356 0.0318527221679685 0.0301996866861981 0.0285148620605466 0.0296910603841148 0.0300407409667971 0.0271479288736977 0.0283241271972658 0.0268300374348956 0.0265439351399741 0.0254631042480467 0.0263849894205731 0.0246047973632814 0.0240643819173175 0.0235557556152345 0.0228563944498696 0.0221252441406251 0.0221252441406248 0.0228246053059897 0.0208536783854165 0.0223477681477866 0.0195503234863283 0.0212987263997394 0.0193277994791668 0.0180562337239582 0.0193277994791668 0.0188827514648436 0.018755594889323 0.0196774800618491 0.0183423360188801 0.0182151794433592 0.0177383422851566 0.0165939331054686 0.0169118245442707 0.0183105468750004 0.0163396199544265 0.015354156494141 0.0157674153645837 0.0158309936523431 0.0154177347819014 0.0156084696451822 0.0165621439615884 0.0142097473144534 0.0149091084798176 0.0139554341634113 0.0134468078613284 0.0137964884440103 0.0123023986816405 0.0125249226888024 0.0122388203938797 0.0134785970052086 0.0127792358398436 0.0122706095377603 0.0115076700846357 0.0126520792643228 0.0122388203938801 0.0125249226888024 0.0122388203938801 0.0116984049479166 0.0110626220703127 0.0108400980631506 0.00995000203450542 0.0100771586100263 0.0100135803222652 0.00975926717122417 0.0104268391927086 0.0102678934733069 0.00934600830078145 0.009822845458984 0.00995000203450542 0.00912348429361999 0.00867843627929655 0.0091870625813804 0.00947316487630229 0.008900960286458 0.0081062316894533 0.00864664713541685 0.00753402709960909 0.00791549682617204 0.00816980997721372 0.00772476196289033 0.00715255737304703 0.00829696655273406 0.00721613566080745 0.0074068705240887 0.00823338826497365 0.00724792480468765 0.00699361165364598 0.00721613566080702 0.00638961791992201 0.00654856363932306 0.0062624613444008 0.00708897908528661 0.00680287679036473 0.0067075093587237 0.00673929850260431 0.00616709391276018 0.00607172648111992 0.00540415445963553 0.00616709391276018 0.00613530476888034 0.0060081481933595 0.00632603963216122 0.00569025675455741 0.00495910644531261 0.00460942586263003 0.00553131103515637 0.0048955281575519 0.00562667846679699 0.00483194986979177 0.00441869099934879 0.00470479329427093 0.00508626302083344 0.004450480143229 0.00502268473307302 0.00391006469726571 0.00416437784830713 0.00476837158203135 0.00441869099934905 0.00502268473307273 0.00397364298502613 0.0044822692871092 0.00413258870442717 0.00362396240234383 0.00349680582682278 0.00371932983398445 0.00349680582682299 0.00406901041666651 0.00378290812174487 0.00384648640950529 0.00352859497070299 0.00314712524414069 0.00343322753906237 0.00381469726562508 0.00298817952473965 0.00362396240234361 0.00289281209309902 0.00356038411458341 0.00289281209309885 0.00333786010742195 0.00292460123697923 0.00289281209309885 0.0038782755533855 0.00254313151041672 0.00301996866861968 0.00301996866861986 0.00241597493489574 0.00270207722981777 0.00257492065429693 0.00270207722981761 0.00263849894205735 0.00222524007161463 0.00254313151041657 0.00263849894205735 0.00263849894205735 0.00219345092773429 0.00216166178385421 0.00260670979817714 0.00263849894205719 0.00244776407877609 0.00209808349609367 0.00257492065429693 0.00187555948893233 0.00241597493489574 0.002129872639974 0.00158945719401045 0.00165303548177077 0.00203450520833338 0.00203450520833338 0.00216166178385408 0.00197092692057296 0.00219345092773429 0.00165303548177087 0.00197092692057296 0.00174840291341139 0.00149408976236982 0.00193913777669275 0.00139872233072911 0.00146230061848961 0.00162124633789066 0.00200271606445305 0.00171661376953129 0.00143051147460941 0.00146230061848953 0.00133514404296878 0.00136693318684891 0.00123977661132815 0.0013987223307292 0.00184377034505201 0.0013987223307292 0.0013987223307292 0.00123977661132808 0.000985463460286479 0.00136693318684891 0.00136693318684899 0.00120798746744794 0.00120798746744787 0.0010490417480469 0.00158945719401045 0.00101725260416663 0.000985463460286479 0.00143051147460932 0.000731150309244807 0.000890096028645852 0.000953674316406214 0.000985463460286479 0.0010490417480469 0.000921885172526007 0.000858306884765643 0.0010490417480469 0.000858306884765592 0.00108083089192711 0.000921885172526007 0.00127156575520836 0.00114440917968752 0.000858306884765592 0.000731150309244807 0.000794728597005225 0.00101725260416663 0.000858306884765643 0.000826517740885434 0.000858306884765592 0.00095367431640627 0.000762939453125016 0.000508626302083314 0.00101725260416669 0.00104904174804684 0.000858306884765643 0.000794728597005225 0.00066757202148435 0.000699361165364598 0.000603993733723971 0.00066757202148435 0.000762939453125016 0.000508626302083344 0.000794728597005178 0.00063578287760418 0.000476837158203135 0.000731150309244764 0.000762939453125016 0.000635782877604143 0.000572204589843762 0.00063578287760418 0.000572204589843728 0.000572204589843762 0.000349680582682299 0.000413258870442693 0.000476837158203135 0.000572204589843762 0.000508626302083314 0.000731150309244807 0.000635782877604143 0.000572204589843762 0.000381469726562508 0.000540415445963521 0.000508626302083344 0.000349680582682299 0.000413258870442693 0.000476837158203135 0.000445048014322926 0.000317891438802071 0.000381469726562508 0.000445048014322926 0.000572204589843728 0.000381469726562508 0.000286102294921864 0.000508626302083344 0.000286102294921881 0.000381469726562486 0.000381469726562508 0.00031789143880209 0.000381469726562486 0.000508626302083344 0.000413258870442717 0.000508626302083314 0.000381469726562508 0.000349680582682299 0.000508626302083314 0.00031789143880209 0.000572204589843728 0.000508626302083344 0.000381469726562508 0.000349680582682278 0.000381469726562508 0.000286102294921881 0.000476837158203107 0.000286102294921881 0.000127156575520836 0.000349680582682278 0.000445048014322926 0.000254313151041657 0.000190734863281254 0.000349680582682299 0.000317891438802071 0.000413258870442717 0.000190734863281254 0.000254313151041657 0.000254313151041672 0.000445048014322926 0.000190734863281243 0.00031789143880209 0.000222524007161463 0.000381469726562486 0.000222524007161463 0.000158945719401036 0.000190734863281254 0.000413258870442717 0.00022252400716145 0.000127156575520836 0.000127156575520836 0.000190734863281243 0.000190734863281254 0.000127156575520836 0.00022252400716145 0.000286102294921881 0.000190734863281243 0.000190734863281254 0.000286102294921881 0.00022252400716145 0.000190734863281254 0.000254313151041672 0.000286102294921864 0 6.3578287760418e-05 0.00022252400716145 0.000286102294921881 0.000222524007161463 0.000286102294921864 0.000158945719401045 9.53674316406214e-05 0.000190734863281254 0.000158945719401045 9.53674316406214e-05 0.000254313151041672 9.5367431640627e-05 0.000286102294921864 0.000158945719401045 0.000158945719401045 6.35782877604143e-05 0.000222524007161463 3.17891438802071e-05 0.000222524007161463 0.000190734863281254 0.000127156575520829 6.3578287760418e-05 0.000190734863281254 0.000127156575520829 6.3578287760418e-05 9.5367431640627e-05 9.53674316406214e-05 6.3578287760418e-05 6.3578287760418e-05 9.53674316406214e-05 6.3578287760418e-05 0.000158945719401036 9.5367431640627e-05 0.000127156575520836 3.17891438802071e-05 3.1789143880209e-05 0.000127156575520836 0.000127156575520829 3.1789143880209e-05 0.000158945719401045 0.000254313151041657 6.3578287760418e-05 0.000190734863281254 0.000158945719401036 0.000158945719401045 0.000127156575520829 9.5367431640627e-05 9.5367431640627e-05 6.35782877604143e-05 0.000190734863281254 3.1789143880209e-05 0 0.000127156575520836 6.3578287760418e-05 3.17891438802071e-05 0.000190734863281254 3.17891438802071e-05 9.5367431640627e-05 3.1789143880209e-05 0.00022252400716145 0.000127156575520836 6.3578287760418e-05 0 0.000190734863281254 6.3578287760418e-05 6.35782877604143e-05 0.000254313151041672 0.000127156575520836 6.35782877604143e-05 0 6.35782877604143e-05 6.3578287760418e-05 6.3578287760418e-05 3.17891438802071e-05 6.3578287760418e-05 9.5367431640627e-05 9.53674316406214e-05 3.1789143880209e-05 6.3578287760418e-05 3.17891438802071e-05 0 0.000127156575520836 6.35782877604143e-05 3.1789143880209e-05 3.17891438802071e-05 9.5367431640627e-05 6.3578287760418e-05 3.17891438802071e-05 6.3578287760418e-05 6.3578287760418e-05 3.17891438802071e-05 3.1789143880209e-05 6.3578287760418e-05 0 6.3578287760418e-05 3.17891438802071e-05 6.3578287760418e-05 9.5367431640627e-05 3.17891438802071e-05 9.5367431640627e-05 6.3578287760418e-05 9.53674316406214e-05 0 6.3578287760418e-05 9.53674316406214e-05 6.3578287760418e-05 9.53674316406327e-05 0 3.17891438802071e-05 0 3.17891438802109e-05 0.000127156575520829 3.17891438802071e-05 6.35782877604218e-05 9.53674316406214e-05 0 0 6.35782877604143e-05 0 9.53674316406327e-05 0 3.17891438802071e-05 0 6.35782877604143e-05 0 3.17891438802109e-05 0 3.17891438802071e-05 0 3.17891438802071e-05 0 0 6.35782877604143e-05 3.17891438802071e-05 0 3.17891438802109e-05 3.17891438802071e-05 0 6.35782877604143e-05 0 6.35782877604218e-05 6.35782877604143e-05 0 3.17891438802109e-05 0 0 9.53674316406327e-05 3.17891438802071e-05 6.35782877604143e-05 3.17891438802109e-05 3.17891438802071e-05 9.53674316406214e-05 0 3.17891438802109e-05 0 6.35782877604143e-05 6.35782877604218e-05 3.17891438802071e-05 6.35782877604143e-05 3.17891438802109e-05 0 6.35782877604143e-05 0 3.17891438802071e-05 3.17891438802071e-05 0 0 3.17891438802071e-05 0 3.17891438802071e-05 3.17891438802071e-05 0 3.17891438802071e-05 3.17891438802071e-05 0 3.17891438802071e-05 3.17891438802071e-05 0 0 0 0 3.17891438802109e-05 0 0 3.17891438802109e-05 0 3.17891438802071e-05 0 0 0 0 0 0 0 0 6.35782877604143e-05 0 0 0 3.17891438802109e-05 3.17891438802071e-05 0 3.17891438802109e-05 0 0 0 0 0 3.17891438802071e-05 0 0 3.17891438802071e-05 0 0 0 0 0 6.35782877604143e-05 0 0 0 0 0 0 0 0 0 0 3.17891438802071e-05 0 0 0 0 3.17891438802071e-05 3.17891438802109e-05 0 9.53674316406214e-05 3.17891438802109e-05 3.17891438802071e-05 0 0 0 3.17891438802071e-05 0 3.17891438802071e-05 0 6.35782877604218e-05 0 0 0 0 0 3.17891438802109e-05 0 3.17891438802071e-05 3.17891438802071e-05 0 6.35782877604143e-05 0 0 0 0 0 0 0 3.17891438802109e-05 0 0 0 0 0 0 0 0 0 0 0 0 3.17891438802071e-05 0 0 0 0 0 0 0 0 0 0 0 3.17891438802109e-05 3.17891438802071e-05 0 0 0 0 0 3.17891438802071e-05 0 0 0 0 3.17891438802109e-05 3.17891438802071e-05 0 3.17891438802109e-05 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 3.17891438802109e-05];

switch params.scanType
    case 'fast'
        values = fastScanVals;
        edges  = fastScanEdges;
    case 'slow'
        values = slowScanVals;
        edges  = slowScanEdges;
    otherwise
        error('unknown scan speed');
end

%% sample from measured distribution of camera noise per pixel and break pixels accordingly
if isscalar(sizes)
    electronNoise = sampleFromEmpiricalDistribution(values,edges,sizes);
else
    if numel(sizes) == 2
        electronNoise =  sampleFromEmpiricalDistribution(values,edges,prod(sizes));
        electronNoise = reshape(electronNoise,sizes);
    elseif numel(sizes) == 3
        if params.extrudeInZ
            electronNoise =  sampleFromEmpiricalDistribution(values,edges,prod(sizes(1:2)));
            electronNoise = reshape(electronNoise,sizes(1:2));
%             % generate broken pixels
%             Npixels = numel(electronNoise);
%             numBrokenPixels = Npixels*percentDeadPixels;
%             sampledBrokenPixels = poissrnd(numBrokenPixels);
%             selectPixelBrokenPixel = randperm(Npixels);
%             selectPixelBrokenPixel = selectPixelBrokenPixel(1:sampledBrokenPixels);
            
            electronNoise = repmat(electronNoise,[1 1 sizes(3)]);
        else
            electronNoise =  sampleFromEmpiricalDistribution(values,edges,prod(sizes));
            electronNoise = reshape(electronNoise,sizes);
        end
    else
        error('did not write the case of more than 3 dimensions');
    end
end



%% convert to requested units
switch params.units
    case 'electrons'
        cameraNoise = electronNoise;
    case 'ADUs'
        cameraNoise = electronNoise / gainElectonsPerCount;
    otherwise
        error('unknown units');
end

%% return in variance
cameraNoiseVar = cameraNoise.^2;
